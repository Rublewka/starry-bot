# setup
import json
import os
import os.path
import discord
import requests
from dotenv import load_dotenv
from discord.ext import commands
from roblox import Client
from config import settings
from src import log
prefix = settings['PREFIX']
client = commands.Bot(command_prefix = commands.when_mentioned_or(settings['PREFIX']), intents=discord.Intents.all())
client.remove_command('help') 
load_dotenv()
RoClient = Client(os.getenv("ROBLOXTOKEN"))
logger = log.setup_logger(__name__)
# setup end

#startup
@client.event
async def on_ready(): 
    logger.info("Logged on as") # startup message in console
    logger.info("""

‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë ‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   
‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù   ‚ñà‚ñà‚ïë   
‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ïö‚ïê‚ïù   

""")
    logger.info(" ____=====Discord=====____")
    logger.info("Bot Info: %s", settings['NAME BOT'])
    logger.info("Bot ID: %s", settings['ID'])
#    rbs = client.get_channel(1076240177032351765)
#    await rbs.send("Successfull restart") # startup message in status channel
#    logger.info("Successfully sent message to Rublewka Bot Status channel")
    logger.info("Bot start success")
    logger.info("____=====Roblox=====____")
    user = await RoClient.get_authenticated_user()
    logger.info("ID: %s", user.id)
    logger.info("Name: %s", user.name)
    logger.info("Roblox session successfully initialized")
# startup end

# variables section

rvr_token = 'rvr2b087uhj4acpftd4vs7dbvgyow4a5ujfz2hkvs0w4j5nzzq8gdftgcadrewulalkx'

# ___________
# colors
DEFAULT = 0
TEAL = 0x1abc9c
DARK_TEAL = 0x11806a
GREEN = 0x2ecc71
DARK_GREEN = 0x1f8b4c
BLUE = 0x3498db
DARK_BLUE = 0x206694
PURPLE = 0x9b59b6
DARK_PURPLE = 0x71368a
MAGENTA = 0xe91e63
DARK_MAGENTA = 0xad1457
GOLD = 0xf1c40f
DARK_GOLD = 0xc27c0e
ORANGE = 0xe67e22
DARK_ORANGE = 0xa84300
RED = 0xe74c3c
DARK_RED = 0x992d22
LIGHTER_GREY = 0x95a5a6
DARK_GREY = 0x607d8b
LIGHT_GREY = 0x979c9f
DARKER_GREY = 0x546e7a
BLURPLE = 0x7289da
GREYPLE = 0x99aab5

# ___________
# variables section end

# Ping
@client.command(aliases = ['Ping', 'PING', 'pING', 'ping', ' ping', ' PING', ' pING', ' Ping'])
async def __ping(ctx): 
    ping = client.ws.latency

    ping_emoji = 'üü©üî≥üî≥üî≥üî≥' # 100ms

    if ping > 0.15000000000000000:
        ping_emoji = 'üüßüü©üî≥üî≥üî≥' # 150ms

    if ping > 0.20000000000000000:
        ping_emoji = 'üü•üüßüü©üî≥üî≥' # 200ms

    if ping > 0.25000000000000000:
        ping_emoji = 'üü•üü•üüßüü©üî≥' # 250ms

    if ping > 0.30000000000000000:
        ping_emoji = 'üü•üü•üü•üüßüü©' # 300ms

    if ping > 0.35000000000000000:
        ping_emoji = 'üü•üü•üü•üü•üüß' # 350ms

    if ping > 0.40000000000000000:
        ping_emoji = 'üü•üü•üü•üü•üü•' # 400ms

    message = await ctx.reply('Please wait a little bit. . .')
    await message.edit(content = f'Pong! {ping_emoji} `{ping * 1000:.0f}ms` :ping_pong:')
#    print(f'[Logs:utils] Bot\'s ping was showen | {prefix}ping')
#    print(f'[Logs:utils] Bot\'s current ping == {ping * 1000:.0f}ms | {prefix}ping')
    # Ping end

# Help
@client.command(aliases = ['Help', 'help', 'HELP', 'hELP', '—Ö–µ–ª–ø', '–•–µ–ª–ø', '–•–ï–õ–ü', '—Ö–ï–õ–ü'])
async def __help (ctx):
#    emb.add_field(name = f'{prefix}help', value = f'`–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —ç—Ç—É –∫–æ–º–∞–Ω–¥—É`', inline=False)
    emb = discord.Embed( title = 'Command navigaation | Help', description = f'**Attention!** Bot is still i development! | Bot\'s prefix: `{prefix}`', colour = TEAL )
    # title - –ñ–∏—Ä–Ω—ã–π –∫—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç (–ó–∞–≥–æ–ª–æ–≤–æ–∫) | description - –¢–µ–∫—Å—Ç –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º | colour - –¶–≤–µ—Ç –ø–æ–ª–æ—Å–∫–∏
    emb.set_author(name=f"{ctx.author}",icon_url=ctx.author.avatar.url)
    # –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ê–≤–∞—Ç–∞—Ä –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
    emb.add_field(name = f'{prefix}help', value = '`Shows this command`', inline=False)
    emb.add_field(name = f'{prefix}ping', value = '`Shows Bot\'s delay in milliseconds (ms)`', inline=False)
    emb.set_thumbnail(url = client.user.avatar.url)
    emb.set_footer( icon_url = client.user.avatar.url, text = 'Rublewka BOT ¬© Copyright 2023 | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã' )

    await ctx.reply ( embed = emb)
#    print(f'[Logs:info] Help command used | {prefix}help ')


@client.command(aliases = ['getuser', 'GETUSER', ' Getuser'])
async def __getuser(ctx):
    for user_mentioned in ctx.message.mentions:
        discordId = user_mentioned.id
    r = requests.get(
        f'https://registry.rover.link/api/guilds/1018415075255668746/discord-to-roblox/{discordId}',
        headers={'Authorization': f'Bearer {rvr_token}'},
        timeout=10)
    data = r.json()
    json_str = json.dumps(data)
    resp = json.loads(json_str)
    print(resp) #use if debug needed
#    user = await RoClient.get_user(resp['robloxId'])
#    if user.description == '':
#        desc = '*None*'
#    else:
#        desc = user.description



# Filter
#@client.event
#async def on_message( message ):
#    await client.process_commands( message )
#    msg = message.content.lower()
#    if msg in bad_words:
#        await message.delete()
#        await message.author.send(f'{message.author.name}, –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ **Rublewka** –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å/—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–µ –∏–º–µ–Ω–∞')
#        print(f'[Logs:moderation] Message sent by {message.author.username} has been deleted due to filter violations')
#_______________


#–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç/–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
#\/\/\/

#Kick
#@client.command(aliases = ['Kick', 'kICK', 'KICK', 'kick'])
#@commands.has_permissions ( administrator = True ) # –ö–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–º–µ—é—â–∏—Ö —Ä–æ–ª—å —Å –ø—Ä–∞–≤–∞–º–∏ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"
#async def __kick(ctx, member: discord.Member, *, reason = None): # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è __kick(ctx, member: discord.Member, *, reason = None)
    #–ê—Ä–≥—É–º–µ–Ω—Ç—ã: ctx - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    #–ê—Ä–≥—É–º–µ–Ω—Ç—ã: member: discord.Member - "member" ----- –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Ç–µ–∫—Å—Ç, –Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—é member (Discord.Member - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è id —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
    #–ê—Ä–≥—É–º–µ–Ω—Ç—ã: * - –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º
    #–ê—Ä–≥—É–º–µ–Ω—Ç—ã: reason = None - "reason" ----- –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Ç–µ–∫—Å—Ç, –Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª reason, "None" - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
#    await ctx.message.add_reaction('‚úÖ') # –î–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–∞–∫—Ü–∏—é –∫ —Å–æ–æ–±—â–µ–Ω–∏—é —Å –∫–æ–º–∞–Ω–¥–æ–π
#    await member.kick( reason = reason ) # –ö–∏–∫–Ω—É—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –ø—Ä–∏—á–∏–Ω–µ (–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø—Ä–∏—á–∏–Ω—É –±–æ—Ç–∞ –≤ –ø—Ä–∏—á–∏–Ω—É –¥–∏—Å–∫–æ—Ä–¥–∞)
#    emb = discord.Embed( title = 'Kicked', description = f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {member}  –±—ã–ª –∫–∏–∫–Ω—É—Ç –ø–æ –ø—Ä–∏—á–∏–Ω–µ { reason } ', colour = discord.Color.red() )
#    emb.set_author( name = client.user.name )
#    emb.set_footer( text = ctx.author.name, icon_url = ctx.author.avatar_url )
#    emb.set_thumbnail(url = client.user.avatar_url)

#    await ctx.send( embed = emb )

#    print(f'[Logs:moderation] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {member} –±—ã–ª –∫–∏–∫–Ω—É—Ç –ø–æ –ø—Ä–∏—á–∏–Ω–µ {reason} | {prefix}kick ')


#@__kick.error
#async def kick_error(ctx, goodbye):
	#if isinstance ( goodbye, commands.MissingRequiredArgument):
		#emb = discord.Embed( title = f'**–ö–æ–º–∞–Ω–¥–∞ "{prefix}–∫–∏–∫"**', description = f'–ò–∑–≥–æ–Ω—è–µ—Ç —É–∫–∞–∑–∞–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è ', colour = discord.Color.red() )
		#emb.set_author(name = ctx.author.name, icon_url = ctx.author.avatar_url)
		#emb.add_field( name = '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ', value = "!–∫–∏–∫ <@‚Å£–£—á–∞—Å—Ç–Ω–∏–∫ | ID>", inline=False)
		#emb.add_field( name = '–ü—Ä–∏–º–µ—Ä', value = "`!–∫–∏–∫ @‚Å£–£—á–∞—Å—Ç–Ω–∏–∫`\n‚îó –ö–∏–∫–Ω–µ—Ç —É–∫–∞–∑–∞–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞.", inline=False)
		#emb.set_thumbnail(url = client.user.avatar_url)
		#emb.set_footer( icon_url = client.user.avatar_url, text = f"Rublewka BOT  ¬© Copyright 2023 | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã"   )
		#await ctx.send ( embed = emb)
		#print(f"[Logs:error] –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ | {prefix}kick")

	#if isinstance (goodbye, commands.MissingPermissions):
		#emb = discord.Embed( title = f'**–ö–æ–º–∞–Ω–¥–∞ "{prefix}–∫–∏–∫"**', description = f'–ò–∑–≥–æ–Ω—è–µ—Ç —É–∫–∞–∑–∞–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è ', colour = discord.Color.red() )
		#emb.set_author(name = ctx.author.name, icon_url = ctx.author.avatar_url)
		#emb.add_field( name = '–û–®–ò–ë–ö–ê!', value = "–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!", inline=False)
		#emb.set_thumbnail(url = client.user.avatar_url)
		#emb.set_footer( icon_url = client.user.avatar_url, text = f"Rublewka BOT  ¬© Copyright 2023 | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã"   )
		#await ctx.send ( embed = emb)
		#print(f"[Logs:Error] [–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å [{ctx.author}] –ø–æ–ø—ã—Ç–∞–ª—Å—è –∫–∏–∫–Ω—É—Ç—å | {prefix}kick")














































































































































































































client.run (settings['TOKEN']) #DON'T TOUCH IT